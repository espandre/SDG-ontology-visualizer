# Utilities

These utilities are used to generate data used in the development of the goal distance related functionality.

Most of these depend on `requests` version 2.26.0, which can be installed by running `pip install -r requirements.txt` in this folder.

## Data Generator

This utility is used to generate fictional goals and data for municipalities, with some configurability. All the data generated by this utility conforms to the projection model used by the goal distance computation functions. Useful for generating mass amounts of data.

### Configuration

Some configurability can be had by manually editing `datagen.py`:

1. Server IP / url
	By default, the data generator tries to access a backend server hosted at `http://localhost:3001`. To change this, change `BASE_URL` to point to the backend server (api server) instead of localhost.

2. Batch vs Single data point insertion
	The data generator defaults to batch data insert in order to reduce the required processing time. Single data point insertion mode can be enabled by setting `SEND_BULK_DATA` to `False`.

3. Goal / Data 
	Goals and data are generated based on configurable pararmeters (or 'levels') that determine the value of the goals and data. The levels are in the range [ `u4ssc.TERRIBLE`, `u4ssc.BAD`, `u4ssc.ACCEPTABLE`, `u4ssc.GOOD`, `u4ssc.BEST` ] from worst to best. In addition to the value, the data level also controls variability. The table below details the default settings, and by editing that table (in `datagen.py`) you affect the generated goals / data.

```python
	
municipalities = {
	# code 		 name 			goal level			data level
	"no.5001": ("Trondheim", 	u4ssc.GOOD, 		u4ssc.GOOD),
	"no.0301": ("Oslo", 		u4ssc.GOOD,			u4ssc.ACCEPTABLE),
	"no.1301": ("Bergen", 		u4ssc.GOOD, 		u4ssc.BAD),
	"no.1103": ("Stavanger", 	u4ssc.GOOD, 		u4ssc.ACCEPTABLE),
	"no.3025": ("Asker", 		u4ssc.GOOD, 		u4ssc.BEST),
	"se.0380": ("Uppsala", 		u4ssc.GOOD, 		u4ssc.ACCEPTABLE),
	"se.1280": ("Malmö", 		u4ssc.ACCEPTABLE, 	u4ssc.TERRIBLE),
	"se.1480": ("Göteborg", 	u4ssc.GOOD, 		u4ssc.GOOD),
	"se.1281": ("Lund", 		u4ssc.GOOD, 		u4ssc.ACCEPTABLE),
	"fi.837":  ("Tampere", 		u4ssc.GOOD, 		u4ssc.ACCEPTABLE),
	"fi.853":  ("Turku", 		u4ssc.BAD, 			u4ssc.TERRIBLE),
	"nl.0080": ("Leeuwarden", 	u4ssc.GOOD, 		u4ssc.GOOD),
	"nl.0268": ("Nijmegen", 	u4ssc.GOOD, 		u4ssc.BEST),
	"nl.0363": ("Amsterdam", 	u4ssc.GOOD, 		u4ssc.BAD),
	"nl.0599": ("Rotterdam", 	u4ssc.ACCEPTABLE, 	u4ssc.ACCEPTABLE),
	"nl.0772": ("Eindhoven", 	u4ssc.GOOD, 		u4ssc.ACCEPTABLE),
	"lt.16":   ("Kaunas",		u4ssc.ACCEPTABLE, 	u4ssc.BAD),
}
```

An additional level of configurability of the data generation is found in the `skip_probability` dict.

```python
skip_probability = {
	# code 		goal, 	data series, 	data point
	"se.1281": (0.05, 	0.1, 			0.05),   
	"no.1103": (0.05, 	0.05, 			0.025), 
	"nl.0772": (0.05, 	0.1, 			0.1),  
}
```

1. `code` is the municipality code
2. `goal` is the probability (for the given municipality) that a kpi does not generate a goal
3. `data series` is the probability (for the given municipality) that a kpi does not generate a data series (ie. no values for any year).
4. `data point` is the probability (for the given municipality) that a kpi does not generate a data point (evaluated each year generated).

### Examples

Generate data in RDF format and output to file:

`python datagen.py rdf > SDG_Ontology_DATA.owl`

Generate data and push to server:

`python datagen.py`

## Correlation Generator

This utility generates correlation data in rdf/owl format from data extracted from the IGES SDG interlinkages tool. The output is printed to stdout, so you should redirect it to an appropriate file. NOTE: the output is not valid rdf/owl by it self, but designed to be copied into an OWL file at an appropriate place.

Optional parameter: country code. If no parameter is given, all available data is generated.

### Examples

Generate correlation data for South Korea:
`python correlation_rdf.py kr > correlations.kr.xml` 

Generate correlation data for all available countries:
`python correlation_rdf.py > correlations.xml`

## Demo Sprint 2

These utilities were used for the demonstration part of the sprint review of sprint 2.

### Correlated KPIs
Displays correlated KPIs along with their approximate factors.

### Extract Goals
Displays the goal data for either Trondheim, Oslo, or Lund (based on parameter given).

### Goal Distance Computation
Displays the output of the goal distance computation for the given municipality (either Trondheim or Oslo) for the given year.

## GDC Test
Utility used to extract data for snapshot testing of the GDC functionality. Also requires manually enabling some functionality on the server.

## Make User
Adds a user with a given role.

`python make_user.py [username] [password] [role]`

Role must be one of `admin` or `dataentry`
Username must be unique.

### Configuration

Server IP / url:
default, the utility tries to access a backend server hosted at `http://localhost:3001`. To change this, change `BASE_URL` to point to the backend server (api server) instead of localhost.

## Stats Expr

Utility to generate expression to calculate expected value and standard deviance for some expressions. Not used in the end.